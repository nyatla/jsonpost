# JsonPostのアクセス制御


JsonPostは、PowStampを利用してクライアントのファイルアップロードリクエストの正当性を検証しつつ、クライアント毎に適正な利用を促すための制御を行います。
JsonPostのアクセス制御は、次の機能によって実現されます。

- **クライアントの識別**:クライアントの識別にはPowStampに含まれるECDSA署名を利用します。
- **アクセス条件の提示**：アップロードサイズとアクセス間隔の評価方式(TimeLogiticsSizeLogNormal関数)により、適正なPowStampスコアの閾値（ハッシングコスト）をクライアントに提示します。
- **Nonceによる生存期間管理**：各アカウントの`nonce`を利用してアカウントの生存期間を管理し、過剰な利用を抑制します。


## クライアントの識別

JsonPostはファイルアップロードについて、クライアントのアカウントを識別します。これは各クライアントの利用状況を個別に管理し、利用状況に応じたアクセス条件を提示するためです。クライアントの識別はECDSA署名とパブリックキーにより実装します。


## アクセス条件の提示

JsonPostはクライアントのファイルアップロードについて、その実施間隔とコンテンツの適正度（ファイルサイズ）を評価して、それに応じたPoW難易度を計算し、クライアントに提示します。難易度は適正と定められる目標値との差に比例して増加しますが、目標値に接近していれば0となります。

難易度はPowStampのスコア閾値として表現し、クライアントに通知します。
クライアントは受け取った難易度に対して次の動作をすることが選択できます。

- Powハッシングによってスコア閾値を満たす。
- 目標値にあわせてアクセス頻度とファイルサイズを調整する。

具体的な難易度計算は、[TimeLogiticsSizeLogNormal方式](./TimeLogiticsSizeLogNormal方式.md)を使用します。


## Nonceによる生存期間管理

JsonPostにおいて、Nonceには次の2つの役割があります。

- 加算Nonce
- PowScoreハッシングの値空間

Nonceの主な役割は、サーバー内でのリプレイプロテクションを実現するための加算Nonceです。しかし、これに加えて、PowScoreのハッシング値空間と組み合わせることで、過剰なハッシング能力に対向します。具体的には、過剰なハッシング能力でアクセス制御を突破しようとするアカウントに対して、加算Nonceが値空間を浪費させることで、生存期間の短縮という形でペナルティを与えることが可能です。





